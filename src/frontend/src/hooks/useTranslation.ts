import { useState, useEffect, createContext, useContext, ReactNode } from 'react';

type Language = 'pt' | 'en';

interface TranslationContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const translations = {
  pt: {
    'auth.initializing': 'A inicializar...',
    'auth.tagline': 'Plataforma soberana de gig economy no ICP',
    'auth.welcome': 'Bem-vindo ao CanisterTask',
    'auth.loginRequired': 'Faça login com Internet Identity para continuar',
    'auth.login': 'Entrar',
    'auth.logout': 'Sair',
    'auth.loggingIn': 'A entrar...',
    'auth.disclaimer': 'Ao entrar, concorda com os nossos Termos de Serviço e Política de Privacidade',
    'age.title': 'Verificação de Idade',
    'age.description': 'Esta plataforma requer que tenha pelo menos 18 anos',
    'age.requirement': 'Ao continuar, confirma que tem 18 anos ou mais e aceita os termos da plataforma.',
    'age.confirm': 'Confirmo que tenho 18+ anos',
    'profile.setup.title': 'Configure o seu perfil',
    'profile.setup.description': 'Escolha o tipo de perfil para começar',
    'profile.type.humanWorker': 'Trabalhador Humano',
    'profile.type.humanWorkerDesc': 'Execute tarefas e ganhe recompensas',
    'profile.type.aiAgent': 'Agente IA / Cliente',
    'profile.type.aiAgentDesc': 'Crie e gira tarefas',
    'profile.name': 'Nome',
    'profile.namePlaceholder': 'O seu nome',
    'profile.agentName': 'Nome do Agente',
    'profile.agentNamePlaceholder': 'Nome do seu agente IA',
    'profile.description': 'Descrição',
    'profile.descriptionPlaceholder': 'Descreva o seu agente ou serviço',
    'profile.skills.label': 'Competências',
    'profile.skills.photography': 'Fotografar locais',
    'profile.skills.delivery': 'Entregas rápidas',
    'profile.skills.verification': 'Verificações presenciais',
    'profile.skills.arCaptures': 'Capturas AR',
    'profile.skills.customPlaceholder': 'Competência personalizada',
    'profile.skills.add': 'Adicionar',
    'profile.location.lat': 'Latitude',
    'profile.location.lon': 'Longitude',
    'profile.location.radius': 'Raio de ação (km)',
    'profile.price': 'Preço por tarefa (€)',
    'profile.saving': 'A guardar...',
    'profile.save': 'Guardar Perfil',
    'gdpr.title': 'Consentimento GDPR',
    'gdpr.consent': 'Aceito o processamento dos meus dados pessoais de acordo com a',
    'gdpr.privacyPolicy': 'Política de Privacidade',
    'gdpr.and': 'e os',
    'gdpr.terms': 'Termos de Serviço',
    'nav.dashboard': 'Dashboard',
    'nav.analytics': 'Análises',
    'nav.settings': 'Definições',
    'nav.about': 'Sobre',
    'footer.tagline': 'Plataforma soberana de gig economy no ICP',
    'footer.shareText': 'Descubra o CanisterTask - Gig economy descentralizada no ICP!',
    'footer.links': 'Links',
    'footer.about': 'Sobre',
    'footer.privacy': 'Privacidade',
    'footer.terms': 'Termos',
    'footer.legal': 'Legal',
    'footer.legalText': 'Plataforma soberana ICP. Não custodiamos fundos. Pagamentos via ramps regulados EU/PT.',
    'footer.builtWith': 'Construído com',
    'footer.using': 'usando',
    'dashboard.title': 'Dashboard do Trabalhador',
    'dashboard.welcome': 'Bem-vindo de volta',
    'dashboard.noTasks': 'Nenhuma tarefa disponível no momento',
    'dashboard.loading': 'A carregar tarefas...',
    'analytics.title': 'Análises',
    'analytics.description': 'Veja as suas estatísticas e ganhos',
    'settings.title': 'Definições',
    'settings.description': 'Gerir a sua conta e preferências',
    'about.title': 'Sobre o CanisterTask',
    'about.creator': 'Criado por Hermínio Coragem (HCoragem) de Évora, Portugal',
    'privacy.title': 'Política de Privacidade',
    'terms.title': 'Termos de Serviço',
    'payment.success': 'Pagamento bem-sucedido!',
    'payment.failure': 'Pagamento falhou',
  },
  en: {
    'auth.initializing': 'Initializing...',
    'auth.tagline': 'Sovereign gig economy platform on ICP',
    'auth.welcome': 'Welcome to CanisterTask',
    'auth.loginRequired': 'Login with Internet Identity to continue',
    'auth.login': 'Login',
    'auth.logout': 'Logout',
    'auth.loggingIn': 'Logging in...',
    'auth.disclaimer': 'By logging in, you agree to our Terms of Service and Privacy Policy',
    'age.title': 'Age Verification',
    'age.description': 'This platform requires you to be at least 18 years old',
    'age.requirement': 'By continuing, you confirm that you are 18 years or older and accept the platform terms.',
    'age.confirm': 'I confirm I am 18+ years old',
    'profile.setup.title': 'Set up your profile',
    'profile.setup.description': 'Choose your profile type to get started',
    'profile.type.humanWorker': 'Human Worker',
    'profile.type.humanWorkerDesc': 'Complete tasks and earn rewards',
    'profile.type.aiAgent': 'AI Agent / Client',
    'profile.type.aiAgentDesc': 'Create and manage tasks',
    'profile.name': 'Name',
    'profile.namePlaceholder': 'Your name',
    'profile.agentName': 'Agent Name',
    'profile.agentNamePlaceholder': 'Your AI agent name',
    'profile.description': 'Description',
    'profile.descriptionPlaceholder': 'Describe your agent or service',
    'profile.skills.label': 'Skills',
    'profile.skills.photography': 'Location Photography',
    'profile.skills.delivery': 'Fast Deliveries',
    'profile.skills.verification': 'On-site Verifications',
    'profile.skills.arCaptures': 'AR Captures',
    'profile.skills.customPlaceholder': 'Custom skill',
    'profile.skills.add': 'Add',
    'profile.location.lat': 'Latitude',
    'profile.location.lon': 'Longitude',
    'profile.location.radius': 'Action radius (km)',
    'profile.price': 'Price per task (€)',
    'profile.saving': 'Saving...',
    'profile.save': 'Save Profile',
    'gdpr.title': 'GDPR Consent',
    'gdpr.consent': 'I accept the processing of my personal data according to the',
    'gdpr.privacyPolicy': 'Privacy Policy',
    'gdpr.and': 'and',
    'gdpr.terms': 'Terms of Service',
    'nav.dashboard': 'Dashboard',
    'nav.analytics': 'Analytics',
    'nav.settings': 'Settings',
    'nav.about': 'About',
    'footer.tagline': 'Sovereign gig economy platform on ICP',
    'footer.shareText': 'Discover CanisterTask - Decentralized gig economy on ICP!',
    'footer.links': 'Links',
    'footer.about': 'About',
    'footer.privacy': 'Privacy',
    'footer.terms': 'Terms',
    'footer.legal': 'Legal',
    'footer.legalText': 'Sovereign ICP platform. We do not custody funds. Payments via EU/PT regulated ramps.',
    'footer.builtWith': 'Built with',
    'footer.using': 'using',
    'dashboard.title': 'Worker Dashboard',
    'dashboard.welcome': 'Welcome back',
    'dashboard.noTasks': 'No tasks available at the moment',
    'dashboard.loading': 'Loading tasks...',
    'analytics.title': 'Analytics',
    'analytics.description': 'View your statistics and earnings',
    'settings.title': 'Settings',
    'settings.description': 'Manage your account and preferences',
    'about.title': 'About CanisterTask',
    'about.creator': 'Created by Hermínio Coragem (HCoragem) from Évora, Portugal',
    'privacy.title': 'Privacy Policy',
    'terms.title': 'Terms of Service',
    'payment.success': 'Payment successful!',
    'payment.failure': 'Payment failed',
  },
};

export function useTranslation() {
  const [language, setLanguageState] = useState<Language>(() => {
    const saved = localStorage.getItem('language');
    if (saved === 'pt' || saved === 'en') return saved;
    return navigator.language.startsWith('pt') ? 'pt' : 'en';
  });

  useEffect(() => {
    localStorage.setItem('language', language);
  }, [language]);

  const t = (key: string): string => {
    return translations[language][key as keyof typeof translations.pt] || key;
  };

  return { language, setLanguage: setLanguageState, t };
}
